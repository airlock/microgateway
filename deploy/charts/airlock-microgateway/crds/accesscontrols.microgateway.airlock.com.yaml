apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  labels:
    app.kubernetes.io/name: airlock-microgateway-operator
    app.kubernetes.io/version: 4.8.0-alpha1
  name: accesscontrols.microgateway.airlock.com
spec:
  group: microgateway.airlock.com
  names:
    categories:
      - airlock-microgateway
    kind: AccessControl
    listKind: AccessControlList
    plural: accesscontrols
    singular: accesscontrol
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: AccessControl defines a rule-based policy for enforcing authentication, authorization and performing identity propagation.
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: spec defines the desired access control configuration.
              properties:
                policies:
                  description: policies configures access control policies. The first matching policy (from top to bottom) applies.
                  items:
                    properties:
                      authorization:
                        description: authorization configures how requests are authorized. An empty object value {} disables authorization.
                        properties:
                          authentication:
                            description: authentication specifies that clients need to be authenticated with the provided method.
                            properties:
                              jwt:
                                description: jwt configures client authentication using JWT.
                                properties:
                                  jwtRef:
                                    description: jwtRef selects the JWT configuration to apply.
                                    properties:
                                      name:
                                        description: name of the resource
                                        maxLength: 253
                                        minLength: 1
                                        type: string
                                    required:
                                      - name
                                    type: object
                                required:
                                  - jwtRef
                                type: object
                              oidc:
                                description: oidc configures client authentication using OpenID Connect.
                                properties:
                                  introspection:
                                    description: introspection configures how token introspection is performed. An empty object value {} defaults to the _always_ strategy.
                                    properties:
                                      strategy:
                                        description: strategy defines the behavior for token introspection.
                                        properties:
                                          always:
                                            description: always strategy defines a strategy for checking every request.
                                            properties:
                                              onError:
                                                default: Block
                                                description: |-
                                                  onError specifies the behavior for a request if the token introspection returns an error, e.g., timeouts or 5xx errors.
                                                  _Block_: The current in-flight request is blocked.
                                                  _InvalidateToken_: Behaves as if the token introspection had returned `false`. This results in an invalidation of the current and requesting of a new token.
                                                  _Pass_: Behaves as if the token introspection had returned `true`.
                                                enum:
                                                  - Block
                                                  - InvalidateToken
                                                  - Pass
                                                type: string
                                            type: object
                                          periodic:
                                            description: |-
                                              periodic strategy defines a time-based strategy for checking requests.
                                              Introspection is non-blocking, concurrent requests proceed without delay.
                                            properties:
                                              onError:
                                                default: InvalidateToken
                                                description: |-
                                                  onError specifies the behavior for a request if the token introspection returns an error, e.g., timeouts or 5xx errors.
                                                  _InvalidateToken_: Behaves as if the token introspection had returned `false`. This results in an invalidation of the current and requesting of a new token.
                                                  _Pass_: Behaves as if the token introspection had returned `true`.
                                                enum:
                                                  - InvalidateToken
                                                  - Pass
                                                type: string
                                              period:
                                                description: |-
                                                  period specifies the minimum time interval between token introspections for requests part of the same session. Once the interval has elapsed, introspection will be performed for the next request in the session.
                                                  Must be >= '1s'.
                                                type: string
                                                x-kubernetes-validations:
                                                  - message: Period must be >= '1s'.
                                                    rule: duration(self) >= duration('1s')
                                            required:
                                              - period
                                            type: object
                                          random:
                                            description: |-
                                              random strategy defines a probabilistic strategy for checking the `x-th` request.
                                              Introspection is non-blocking, concurrent requests proceed without delay.
                                            properties:
                                              onError:
                                                default: InvalidateToken
                                                description: |-
                                                  onError specifies the behavior for a request if the token introspection returns an error, e.g., timeouts or 5xx errors.
                                                  _InvalidateToken_: Behaves as if the token introspection had returned `false`. This results in an invalidation of the current and requesting of a new token.
                                                  _Pass_: Behaves as if the token introspection had returned `true`.
                                                enum:
                                                  - InvalidateToken
                                                  - Pass
                                                type: string
                                              probability:
                                                description: |-
                                                  probability specifies the probability in % with which a request is selected to be introspected.
                                                  A valid value for probability must be from the range: [`0.01%`,`99.99%`].
                                                  To introspect the token on every request the _always_ strategy must be used.
                                                maxLength: 6
                                                minLength: 2
                                                type: string
                                                x-kubernetes-validations:
                                                  - message: 'Probability must have a value from the valid range: [`0.01%`,`99.99%`]'
                                                    rule: self.matches(r"""^[1-9]?[0-9](\.[0-9]{1,2})?%$""") && self != '0%' && self != '0.0%' && self != '0.00%'
                                            required:
                                              - probability
                                            type: object
                                        type: object
                                    type: object
                                  oidcRelyingPartyRef:
                                    description: oidcRelyingPartyRef configures how the Airlock Microgateway Engine interacts with the OpenID provider.
                                    properties:
                                      name:
                                        description: name of the resource
                                        maxLength: 253
                                        minLength: 1
                                        type: string
                                    required:
                                      - name
                                    type: object
                                required:
                                  - oidcRelyingPartyRef
                                type: object
                            type: object
                          deny:
                            description: deny specifies to deny access for all requests matching this policy.
                            type: object
                          requireAll:
                            description: requireAll specifies conditions which must all be satisfied for the request to be authorized.
                            items:
                              properties:
                                clientCertificate:
                                  description: |-
                                    clientCertificate specifies a condition on the presented client certificate.
                                    If no client certificate is presented, the condition is never satisfied.
                                  properties:
                                    hash:
                                      description: hash specifies a condition on the SHA256 hash/fingerprint of the DER encoded presented client certificate.
                                      properties:
                                        in:
                                          description: in specifies that the hash must match one of these values.
                                          properties:
                                            values:
                                              description: values is a list of hex encoded SHA256 hashes (e.g., df6ff72fe9116521268f6f2dd4966f51df479883fe7037b39f75916ac3049d1a) or fingerprints (e.g., DF:6F:F7:2F:E9:11:65:21:26:8F:6F:2D:D4:96:6F:51:DF:47:98:83:FE:70:37:B3:9F:75:91:6A:C3:04:9D:1A).
                                              items:
                                                maxLength: 95
                                                minLength: 64
                                                pattern: ^[0-9a-fA-F]{64}$|^[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){31}$
                                                type: string
                                              maxItems: 1024
                                              minItems: 1
                                              type: array
                                              x-kubernetes-list-type: set
                                            valuesFrom:
                                              description: valuesFrom selects the source from which to extract the list of hex encoded SHA256 hashes (e.g., df6ff72fe9116521268f6f2dd4966f51df479883fe7037b39f75916ac3049d1a) or fingerprints (e.g., DF:6F:F7:2F:E9:11:65:21:26:8F:6F:2D:D4:96:6F:51:DF:47:98:83:FE:70:37:B3:9F:75:91:6A:C3:04:9D:1A).
                                              properties:
                                                configMapRef:
                                                  description: configMapRef defines the reference to a configmap containing a list of hex-encoded SHA-256 hashes under the key 'fingerprints.txt'. Each line represents one fingerprint, blank lines and comments beginning with ‘#’ are ignored.
                                                  properties:
                                                    name:
                                                      description: name of the resource
                                                      maxLength: 253
                                                      minLength: 1
                                                      type: string
                                                  required:
                                                    - name
                                                  type: object
                                              required:
                                                - configMapRef
                                              type: object
                                          type: object
                                      required:
                                        - in
                                      type: object
                                    issuer:
                                      description: |-
                                        issuer specifies a condition on the issuer fields of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        field:
                                          description: field selects the issuer field to match.
                                          enum:
                                            - CommonName
                                            - Organization
                                            - OrganizationalUnit
                                            - Country
                                            - State
                                            - Locality
                                          type: string
                                        value:
                                          description: |-
                                            value which the selected issuer field must match.
                                            If the selected field occurs multiple times in the certificate (e.g., multiple organizational units), the value of at least one of them must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - field
                                        - value
                                      type: object
                                    san:
                                      description: |-
                                        san specifies a condition on the subject alternative names of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        type:
                                          description: type selects the SAN type to match.
                                          enum:
                                            - DNS
                                            - Email
                                            - URI
                                            - IPAddress
                                          type: string
                                        value:
                                          description: value which at least one of the subject alternative names of the specified type must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - type
                                        - value
                                      type: object
                                    subject:
                                      description: |-
                                        subject specifies a condition on the subject fields of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        field:
                                          description: field selects the subject field to match.
                                          enum:
                                            - CommonName
                                            - Organization
                                            - OrganizationalUnit
                                            - Country
                                            - State
                                            - Locality
                                          type: string
                                        value:
                                          description: |-
                                            value which the selected subject field must match.
                                            If the selected field occurs multiple times in the certificate (e.g., multiple organizational units), the value of at least one of them must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - field
                                        - value
                                      type: object
                                  type: object
                                jwt:
                                  description: jwt specifies a condition on the JWT.
                                  properties:
                                    claim:
                                      description: claim specifies a condition on a JWT claim.
                                      properties:
                                        name:
                                          description: name of the claim.
                                          maxLength: 256
                                          minLength: 1
                                          type: string
                                        value:
                                          description: |-
                                            value of the claim. If not specified, only existence of the claim is checked (any value is allowed).

                                            Value matching is only supported if the data type of the claim is either primitive (`number`, `boolean`, `string`) or `array` of primitives.
                                            In case of a non-string value, the match will be performed against the stringified value.

                                            If the claim has an unsupported data type (e.g. `object` or `null`), its value will never match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - name
                                      type: object
                                  required:
                                    - claim
                                  type: object
                                oidc:
                                  description: oidc specifies a condition on the result of an OpenID Connect flow.
                                  properties:
                                    claim:
                                      description: claim specifies a condition on an ID token claim.
                                      properties:
                                        name:
                                          description: name of the claim.
                                          maxLength: 256
                                          minLength: 1
                                          type: string
                                        value:
                                          description: |-
                                            value of the claim. If not specified, only existence of the claim is checked (any value is allowed).

                                            Value matching is only supported if the data type of the claim is either primitive (`number`, `boolean`, `string`) or `array` of primitives.
                                            In case of a non-string value, the match will be performed against the stringified value.

                                            If the claim has an unsupported data type (e.g. `object` or `null`), its value will never match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - name
                                      type: object
                                  required:
                                    - claim
                                  type: object
                              type: object
                            maxItems: 64
                            minItems: 1
                            type: array
                          requireAny:
                            description: requireAny specifies conditions of which at least one must be satisfied for the request to be authorized.
                            items:
                              properties:
                                clientCertificate:
                                  description: |-
                                    clientCertificate specifies a condition on the presented client certificate.
                                    If no client certificate is presented, the condition is never satisfied.
                                  properties:
                                    hash:
                                      description: hash specifies a condition on the SHA256 hash/fingerprint of the DER encoded presented client certificate.
                                      properties:
                                        in:
                                          description: in specifies that the hash must match one of these values.
                                          properties:
                                            values:
                                              description: values is a list of hex encoded SHA256 hashes (e.g., df6ff72fe9116521268f6f2dd4966f51df479883fe7037b39f75916ac3049d1a) or fingerprints (e.g., DF:6F:F7:2F:E9:11:65:21:26:8F:6F:2D:D4:96:6F:51:DF:47:98:83:FE:70:37:B3:9F:75:91:6A:C3:04:9D:1A).
                                              items:
                                                maxLength: 95
                                                minLength: 64
                                                pattern: ^[0-9a-fA-F]{64}$|^[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){31}$
                                                type: string
                                              maxItems: 1024
                                              minItems: 1
                                              type: array
                                              x-kubernetes-list-type: set
                                            valuesFrom:
                                              description: valuesFrom selects the source from which to extract the list of hex encoded SHA256 hashes (e.g., df6ff72fe9116521268f6f2dd4966f51df479883fe7037b39f75916ac3049d1a) or fingerprints (e.g., DF:6F:F7:2F:E9:11:65:21:26:8F:6F:2D:D4:96:6F:51:DF:47:98:83:FE:70:37:B3:9F:75:91:6A:C3:04:9D:1A).
                                              properties:
                                                configMapRef:
                                                  description: configMapRef defines the reference to a configmap containing a list of hex-encoded SHA-256 hashes under the key 'fingerprints.txt'. Each line represents one fingerprint, blank lines and comments beginning with ‘#’ are ignored.
                                                  properties:
                                                    name:
                                                      description: name of the resource
                                                      maxLength: 253
                                                      minLength: 1
                                                      type: string
                                                  required:
                                                    - name
                                                  type: object
                                              required:
                                                - configMapRef
                                              type: object
                                          type: object
                                      required:
                                        - in
                                      type: object
                                    issuer:
                                      description: |-
                                        issuer specifies a condition on the issuer fields of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        field:
                                          description: field selects the issuer field to match.
                                          enum:
                                            - CommonName
                                            - Organization
                                            - OrganizationalUnit
                                            - Country
                                            - State
                                            - Locality
                                          type: string
                                        value:
                                          description: |-
                                            value which the selected issuer field must match.
                                            If the selected field occurs multiple times in the certificate (e.g., multiple organizational units), the value of at least one of them must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - field
                                        - value
                                      type: object
                                    san:
                                      description: |-
                                        san specifies a condition on the subject alternative names of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        type:
                                          description: type selects the SAN type to match.
                                          enum:
                                            - DNS
                                            - Email
                                            - URI
                                            - IPAddress
                                          type: string
                                        value:
                                          description: value which at least one of the subject alternative names of the specified type must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - type
                                        - value
                                      type: object
                                    subject:
                                      description: |-
                                        subject specifies a condition on the subject fields of the presented client certificate.
                                        Note: For security reasons, only client certificates passing TLS validation can satisfy this condition.
                                      properties:
                                        field:
                                          description: field selects the subject field to match.
                                          enum:
                                            - CommonName
                                            - Organization
                                            - OrganizationalUnit
                                            - Country
                                            - State
                                            - Locality
                                          type: string
                                        value:
                                          description: |-
                                            value which the selected subject field must match.
                                            If the selected field occurs multiple times in the certificate (e.g., multiple organizational units), the value of at least one of them must match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - field
                                        - value
                                      type: object
                                  type: object
                                jwt:
                                  description: jwt specifies a condition on the JWT.
                                  properties:
                                    claim:
                                      description: claim specifies a condition on a JWT claim.
                                      properties:
                                        name:
                                          description: name of the claim.
                                          maxLength: 256
                                          minLength: 1
                                          type: string
                                        value:
                                          description: |-
                                            value of the claim. If not specified, only existence of the claim is checked (any value is allowed).

                                            Value matching is only supported if the data type of the claim is either primitive (`number`, `boolean`, `string`) or `array` of primitives.
                                            In case of a non-string value, the match will be performed against the stringified value.

                                            If the claim has an unsupported data type (e.g. `object` or `null`), its value will never match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - name
                                      type: object
                                  required:
                                    - claim
                                  type: object
                                oidc:
                                  description: oidc specifies a condition on the result of an OpenID Connect flow.
                                  properties:
                                    claim:
                                      description: claim specifies a condition on an ID token claim.
                                      properties:
                                        name:
                                          description: name of the claim.
                                          maxLength: 256
                                          minLength: 1
                                          type: string
                                        value:
                                          description: |-
                                            value of the claim. If not specified, only existence of the claim is checked (any value is allowed).

                                            Value matching is only supported if the data type of the claim is either primitive (`number`, `boolean`, `string`) or `array` of primitives.
                                            In case of a non-string value, the match will be performed against the stringified value.

                                            If the claim has an unsupported data type (e.g. `object` or `null`), its value will never match.
                                          properties:
                                            matcher:
                                              description: StringMatcher defines the way to match a string.
                                              properties:
                                                contains:
                                                  description: |-
                                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                exact:
                                                  description: |-
                                                    exact defines an explicit match on the string specified here.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                ignoreCase:
                                                  default: false
                                                  description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                                  type: boolean
                                                prefix:
                                                  description: |-
                                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                regex:
                                                  description: |-
                                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                                suffix:
                                                  description: |-
                                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                                  maxLength: 1024
                                                  minLength: 1
                                                  type: string
                                              type: object
                                          required:
                                            - matcher
                                          type: object
                                      required:
                                        - name
                                      type: object
                                  required:
                                    - claim
                                  type: object
                              type: object
                            maxItems: 64
                            minItems: 1
                            type: array
                        type: object
                      identityPropagation:
                        description: identityPropagation configures how the authenticated user's identity is communicated to the protected application.
                        properties:
                          actions:
                            description: actions specifies the propagation actions.
                            items:
                              properties:
                                identityPropagationRef:
                                  description: identityPropagationRef selects an IdentityPropagation to apply.
                                  properties:
                                    name:
                                      description: name of the resource
                                      maxLength: 253
                                      minLength: 1
                                      type: string
                                  required:
                                    - name
                                  type: object
                              required:
                                - identityPropagationRef
                              type: object
                            maxItems: 64
                            type: array
                            x-kubernetes-list-type: atomic
                          onFailure:
                            description: |-
                              onFailure configures what should happen, if an identity propagation fails. Meaning of the possible values:
                              _Pass_: The request should be forwarded to the upstream, without including the information from the failed identity propagations.
                            enum:
                              - Pass
                            type: string
                        required:
                          - actions
                          - onFailure
                        type: object
                      requestConditions:
                        description: |-
                          requestConditions defines additional request properties which must all be matched in order for this policy to apply. A policy without request conditions will always match.

                          WARNING: There is currently a limitation that if `authentication.oidc` is configured for this policy, you must ensure that the request condition also matches logout requests and callback redirects from the OIDC Provider as configured in the OIDCRelyingParty (`pathMapping.logoutPath` / `pathMapping.redirectPath`).
                        properties:
                          header:
                            description: header defines the matching headers of a request.
                            properties:
                              name:
                                description: name defines the name of a header.
                                properties:
                                  matcher:
                                    description: matcher defines the way to match a string. In comparison to a normal StringMatcher, a value is always matched ignoring the case and can't be inverted.
                                    properties:
                                      contains:
                                        description: |-
                                          contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      exact:
                                        description: |-
                                          exact defines an explicit match on the string specified here.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      prefix:
                                        description: |-
                                          prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      regex:
                                        description: |-
                                          regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                          The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      suffix:
                                        description: |-
                                          suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                    type: object
                                required:
                                  - matcher
                                type: object
                              value:
                                description: value defines the value of a header.
                                properties:
                                  matcher:
                                    description: StringMatcher defines the way to match a string.
                                    properties:
                                      contains:
                                        description: |-
                                          contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      exact:
                                        description: |-
                                          exact defines an explicit match on the string specified here.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      ignoreCase:
                                        default: false
                                        description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                        type: boolean
                                      prefix:
                                        description: |-
                                          prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      regex:
                                        description: |-
                                          regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                          The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                      suffix:
                                        description: |-
                                          suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                          Only one of exact, prefix, suffix, regex or contains can be set.
                                        maxLength: 1024
                                        minLength: 1
                                        type: string
                                    type: object
                                required:
                                  - matcher
                                type: object
                            type: object
                          invert:
                            default: false
                            description: invert indicates whether the request condition should be inverted.
                            type: boolean
                          mediaType:
                            description: mediaType defines the matching media type from the content-type header of a request.
                            properties:
                              matcher:
                                description: |-
                                  NonInvertableCaseInsensitiveStringMatcher defines the way to match a string.
                                  In comparison to a normal StringMatcher, a value is always matched ignoring the case and can't be inverted.
                                properties:
                                  contains:
                                    description: |-
                                      contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  exact:
                                    description: |-
                                      exact defines an explicit match on the string specified here.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  prefix:
                                    description: |-
                                      prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  regex:
                                    description: |-
                                      regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                      The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  suffix:
                                    description: |-
                                      suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                type: object
                            required:
                              - matcher
                            type: object
                          method:
                            description: method defines the matching methods of a request.
                            items:
                              description: Method defines common HTTP methods.
                              enum:
                                - GET
                                - HEAD
                                - POST
                                - PUT
                                - PATCH
                                - DELETE
                                - CONNECT
                                - OPTIONS
                                - TRACE
                              type: string
                            maxItems: 16
                            type: array
                            x-kubernetes-list-type: set
                          path:
                            description: path defines the matching path of a request.
                            properties:
                              matcher:
                                description: StringMatcher defines the way to match a string.
                                properties:
                                  contains:
                                    description: |-
                                      contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  exact:
                                    description: |-
                                      exact defines an explicit match on the string specified here.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  ignoreCase:
                                    default: false
                                    description: ignoreCase indicates whether the matching should be case-insensitive. In case of a regex match, the regex gets wrapped with a group `(?i:...)`.
                                    type: boolean
                                  prefix:
                                    description: |-
                                      prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  regex:
                                    description: |-
                                      regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                      The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                  suffix:
                                    description: |-
                                      suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                      Only one of exact, prefix, suffix, regex or contains can be set.
                                    maxLength: 1024
                                    minLength: 1
                                    type: string
                                type: object
                            required:
                              - matcher
                            type: object
                          remoteIP:
                            description: |-
                              remoteIP defines the matching remote IPs of a request.
                              Note: Depending on your setup you may need to adapt the `remoteIP` configuration in the `SidecarGateway` / `GatewayParameters` resource to ensure correct client IP detection.
                            properties:
                              cidrRanges:
                                description: cidrRanges defines the IPv4 or IPv6 CIDR ranges, e.g. ``196.148.3.128/26`` or ``2001:db8::/28``.
                                items:
                                  description: CIDRRange defines an IPv4 or IPv6 CIDR range, e.g. “196.148.3.128/26“ or “2001:db8::/28“.
                                  format: cidr
                                  maxLength: 49
                                  minLength: 1
                                  type: string
                                maxItems: 1024
                                minItems: 1
                                type: array
                                x-kubernetes-list-type: set
                              invert:
                                default: false
                                description: invert indicates whether the match should be inverted.
                                type: boolean
                            required:
                              - cidrRanges
                            type: object
                        type: object
                      tokenExchange:
                        description: tokenExchange configures how downstream authentication tokens (e.g. JWT or OIDC Access Token) are exchanged with an OAuth2 Token Exchange Server.
                        properties:
                          actions:
                            description: actions specifies the chain of token exchange actions to execute.
                            items:
                              properties:
                                tokenExchangeRef:
                                  description: tokenExchangeRef selects a TokenExchange to perform.
                                  properties:
                                    name:
                                      description: name of the resource
                                      maxLength: 253
                                      minLength: 1
                                      type: string
                                  required:
                                    - name
                                  type: object
                              required:
                                - tokenExchangeRef
                              type: object
                            maxItems: 16
                            minItems: 1
                            type: array
                            x-kubernetes-list-type: atomic
                          onFailure:
                            default: Block
                            description: |-
                              onFailure configures what should happen, if the token exchange fails. Meaning of the possible values:
                              _Block_: The downstream request is blocked.
                              _Pass_: Processing of the downstream request will proceed, but no exchanged token will be available (e.g. for identity propagation).
                            enum:
                              - Block
                              - Pass
                            type: string
                        required:
                          - actions
                        type: object
                    required:
                      - authorization
                    type: object
                  maxItems: 128
                  minItems: 1
                  type: array
                  x-kubernetes-list-type: atomic
              required:
                - policies
              type: object
          required:
            - spec
          type: object
      served: true
      storage: true
      subresources: {}
