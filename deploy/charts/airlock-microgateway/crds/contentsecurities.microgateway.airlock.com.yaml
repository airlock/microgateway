apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  labels:
    app.kubernetes.io/name: airlock-microgateway-operator
    app.kubernetes.io/version: 4.8.0-alpha1
  name: contentsecurities.microgateway.airlock.com
spec:
  group: microgateway.airlock.com
  names:
    categories:
      - airlock-microgateway
    kind: ContentSecurity
    listKind: ContentSecurityList
    plural: contentsecurities
    singular: contentsecurity
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: |-
            ContentSecurity defines a policy for filtering and mutating requests and responses to protect an upstream web application. Individual features can be customized using their dedicated CRDs which are referenced from this policy.

            The default policy is designed to be secure and work with most web applications. Security can be further improved by e.g.,
            - Enforcing an OpenAPI or GraphQL schema to protect API endpoints
            - Enabling CSRF protection
            - Increasing the deny rule strictness level
            - Tightening request limits

            If false positives are encountered (wrongly blocked requests), exceptions may also be configured in the relevant CRDs.
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: spec defines the desired content security configuration.
              properties:
                apiProtection:
                  description: |-
                    apiProtection defines the relevant configurations to protect APIs.
                    If undefined, default settings are applied, designed to work with most upstream web application services.

                    Deprecated: Use policies in APIProtection CRD instead.
                  properties:
                    graphQLRef:
                      description: |-
                        graphQLRef selects the relevant GraphQL configuration resource.
                        If undefined, default settings are applied, designed to work with most upstream web application services.

                        Deprecated: Use policies in APIProtection CRD instead.
                      properties:
                        name:
                          description: name of the resource
                          maxLength: 253
                          minLength: 1
                          type: string
                      required:
                        - name
                      type: object
                    openAPIRef:
                      description: |-
                        openAPIRef selects the relevant OpenAPI configuration resource.
                        If undefined, default settings are applied, designed to work with most upstream web application services.

                        Deprecated: Use policies in APIProtection CRD instead.
                      properties:
                        name:
                          description: name of the resource
                          maxLength: 253
                          minLength: 1
                          type: string
                      required:
                        - name
                      type: object
                  type: object
                apiProtectionRef:
                  description: |-
                    apiProtectionRef defines the relevant configurations to protect multiple APIs on different paths.
                    If undefined, default settings are applied, designed to work with most upstream web application services.
                  properties:
                    name:
                      description: name of the resource
                      maxLength: 253
                      minLength: 1
                      type: string
                  required:
                    - name
                  type: object
                csrfProtectionRef:
                  description: |-
                    csrfProtectionRef selects the relevant CSRF configuration resource.
                    If undefined, CSRF protection is disabled.
                  properties:
                    name:
                      description: name of the resource
                      maxLength: 253
                      minLength: 1
                      type: string
                  required:
                    - name
                  type: object
                filter:
                  description: |-
                    filter defines the set of filters, e.g. Airlock Deny Rules, to be applied to incoming requests
                    to protect against various attack patterns.
                    If undefined, default settings are applied, designed to work with most upstream web application services.
                  properties:
                    denyRulesRef:
                      description: |-
                        denyRulesRef selects the relevant DenyRules configuration resource.
                        If undefined, default settings are applied, designed to work with most upstream web application services.
                      properties:
                        name:
                          description: name of the resource
                          maxLength: 253
                          minLength: 1
                          type: string
                      required:
                        - name
                      type: object
                  type: object
                headerRewritesRef:
                  description: |-
                    headerRewritesRef selects the relevant HeaderRewrites.
                    If undefined, default settings are applied, designed to work with most upstream web application services.
                  properties:
                    name:
                      description: name of the resource
                      maxLength: 253
                      minLength: 1
                      type: string
                  required:
                    - name
                  type: object
                limitsRef:
                  description: |-
                    limitsRef selects the relevant Limits configuration resource.
                    If undefined, default settings are applied, designed to work with most upstream web application services.
                  properties:
                    name:
                      description: name of the resource
                      maxLength: 253
                      minLength: 1
                      type: string
                  required:
                    - name
                  type: object
                parserRef:
                  description: |-
                    parserRef selects the relevant Parser configuration resource.
                    If undefined, default settings are applied, designed to work with most upstream web application services.
                  properties:
                    name:
                      description: name of the resource
                      maxLength: 253
                      minLength: 1
                      type: string
                  required:
                    - name
                  type: object
              type: object
          type: object
      served: true
      storage: true
      subresources: {}
